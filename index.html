@@ -398,51 +398,57 @@
            <div class="form-group">
                <label for="personalMessage">Voeg een persoonlijk bericht toe (optioneel)</label>
                <textarea id="personalMessage" rows="3" placeholder="Ik zag deze vacature en moest aan je denken..."></textarea>
            </div>
            
            <div class="share-buttons-container">
                <a href="#" id="whatsapp-share" class="btn-share whatsapp disabled">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="24" height="24"><path d="M16.6 14.2c-.2-.1-1.5-.7-1.7-.8-.2-.1-.4-.1-.6.1-.2.2-.6.8-.8 1-.1.2-.3.2-.5.1-.2-.1-1-.4-1.9-1.2-.7-.6-1.2-1.4-1.3-1.6s0-.3.1-.4.2-.2.4-.4c.1-.1.2-.3.3-.4.1-.2.1-.3 0-.4-.1-.1-.6-1.5-.8-2.1-.2-.5-.4-.5-.5-.5h-.5c-.2 0-.4.1-.6.3-.2.2-.8.8-.8 1.9s.8 2.2 1 2.4c.1.1 1.5 2.3 3.7 3.2.5.2.9.4 1.2.5.5.2 1 .1 1.3-.1.4-.2.6-.8.8-1s.2-1.1.1-1.2c-.1-.1-.3-.2-.5-.3zM12 2C6.5 2 2 6.5 2 12s4.5 10 10 10 10-4.5 10-10S17.5 2 12 2zm0 18c-4.4 0-8-3.6-8-8s3.6-8 8-8 8 3.6 8 8-3.6 8-8 8z" /></svg>
                    <span>Deel via WhatsApp</span>
                </a>
                <a href="#" id="sms-share" class="btn-share sms disabled">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 512 512" width="24" height="24"><path d="M64 0C28.7 0 0 28.7 0 64V352c0 35.3 28.7 64 64 64h96v80c0 6.1 3.4 11.6 8.8 14.3s11.9 2.1 16.8-1.5L309.3 416H448c35.3 0 64-28.7 64-64V64c0-35.3-28.7-64-64-64H64z"/></svg>
                    <span>Deel via SMS</span>
                </a>
            </div>
        </div>
    </div>

    <script>
        const modal = document.getElementById('referralModal');
        const personalMessageEl = document.getElementById('personalMessage');
        const whatsappShareBtn = document.getElementById('whatsapp-share');
        const smsShareBtn = document.getElementById('sms-share');
        const referrerEmailEl = document.getElementById('referrerEmail');
        
        const apiEndpointUrl = '/.netlify/functions/send-email'; 
        // Adjust the endpoint depending on where the page is hosted. When the
        // page runs on Netlify itself we can call the function via a relative
        // path. Otherwise we need the full URL to the deployed Netlify site.
        const NETLIFY_SITE_URL = 'https://visionary-fox-2db954.netlify.app';
        const apiEndpointUrl = window.location.hostname.endsWith('netlify.app')
            ? '/.netlify/functions/send-email'
            : `${NETLIFY_SITE_URL}/.netlify/functions/send-email`;

        let personalCode = '';
        let referralUrl = '';

        function generateReferralInfo() {
            personalCode = 'REF' + Math.random().toString(36).substr(2, 6).toUpperCase();
            referralUrl = 'https://stormhoogervorst.github.io/referapply/';
        }
        
        function updateShareLinks() {
            const personalMsg = personalMessageEl.value.trim();
            const vacancyTitle = document.querySelector('.vacancy-header h1').textContent.trim();
            let baseText;
            if (personalMsg) {
                baseText = `${personalMsg}\n\nBekijk de vacature hier:`;
            } else {
                baseText = `Hoi! Ik zag deze vacature voor een '${vacancyTitle}' en moest aan je denken. Misschien is het iets voor jou?\n\nBekijk de vacature hier:`;
            }
            const fullShareText = `${baseText} ${referralUrl}\n\nMijn persoonlijke code is: ${personalCode}`;
            whatsappShareBtn.href = `https://api.whatsapp.com/send?text=${encodeURIComponent(fullShareText)}`;
            smsShareBtn.href = `sms:?&body=${encodeURIComponent(fullShareText)}`;
        }
        
        function openModal() {
            generateReferralInfo();
